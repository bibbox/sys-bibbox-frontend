import React        from 'react';
import ReactDOM     from 'react-dom';



const installIcon = "M1000,937.667c0,33.138-26.864,60.002-60.002,60.002H60.003C26.864,997.669,0,970.805,0,937.667c0-33.139,26.864-60.003,60.003-60.003h879.995C973.136,877.664,1000,904.528,1000,937.667z M500,817.443l273.352-273.285H575.003V75.003C575.003,33.58,541.423,0,500,0c-41.423,0-75.003,33.58-75.003,75.003v469.155H226.648L500,817.443z";
const startStopIcon = "M451.523,528.59V47.615c0-26.233,21.267-47.5,47.5-47.5s47.5,21.267,47.5,47.5V528.59c0,26.233-21.267,47.5-47.5,47.5S451.523,554.823,451.523,528.59z M711.563,158.396c-23.034-12.554-51.885-4.056-64.438,18.98s-4.055,51.885,18.98,64.438c113.472,61.835,183.962,180.438,183.962,309.526c0,94.084-36.639,182.536-103.165,249.063c-66.527,66.527-154.979,103.166-249.063,103.166s-182.537-36.639-249.064-103.166S145.609,645.424,145.609,551.34c0-129.281,70.646-247.969,184.369-309.747c23.052-12.522,31.587-41.361,19.065-64.413c-12.522-23.052-41.362-31.586-64.413-19.065C140.281,236.53,50.609,387.206,50.609,551.34c0,60.354,11.831,118.929,35.165,174.097c22.528,53.261,54.769,101.085,95.826,142.143c41.057,41.057,88.881,73.298,142.143,95.825c55.167,23.334,113.742,35.165,174.097,35.165s118.93-11.831,174.097-35.165c53.261-22.527,101.085-54.769,142.142-95.826c41.058-41.057,73.298-88.881,95.825-142.143c23.334-55.167,35.165-113.741,35.165-174.096C945.068,387.45,855.595,236.883,711.563,158.396z";
const restartIcon = "M992.001,507.999c0,66.4-13.015,130.838-38.683,191.522c-24.782,58.593-60.251,111.205-105.421,156.375s-97.782,80.639-156.375,105.421C630.838,986.985,566.4,1000,500,1000s-130.838-13.015-191.523-38.683c-58.592-24.782-111.204-60.251-156.373-105.421c-45.171-45.17-80.64-97.782-105.422-156.375C21.014,638.837,7.999,574.399,7.999,507.999c0-94.006,26.612-185.405,76.962-264.315c32.16-50.405,72.985-94.28,120.361-129.74l-65.975-97.322L459.096,0L325.479,291.191l-69.749-102.89c-37.34,28.562-69.592,63.569-95.152,103.63c-41.137,64.473-62.881,139.188-62.881,216.068c0,107.459,41.848,208.486,117.832,284.471C291.514,868.455,392.541,910.302,500,910.302s208.486-41.847,284.471-117.832c75.985-75.984,117.831-177.012,117.831-284.471c0-65.419-16.042-130.34-46.392-187.744c-29.407-55.622-72.15-104.294-123.606-140.756c-20.21-14.321-24.983-42.314-10.663-62.524c14.321-20.21,42.315-24.984,62.524-10.664c62.867,44.548,115.097,104.031,151.042,172.018C972.361,348.603,992.001,428.021,992.001,507.999z";
const deleteIcon = "M110.3,15.4c0,3-2.4,5.4-5.4,5.4H23.1c-3,0-5.4-2.4-5.4-5.4s2.4-5.4,5.4-5.4h30.5C53.8,4.5,58.4,0,64,0s10.2,4.5,10.4,10.1h30.5C107.9,10.1,110.3,12.5,110.3,15.4z M107.3,28.5c1,1.1,1.5,2.6,1.4,4.1l-7.1,90.5c-0.2,2.8-2.6,5-5.4,5H31.8c-2.8,0-5.1-2.2-5.4-5l-7.1-90.5c-0.1-1.5,0.4-3,1.4-4.1c1-1.1,2.5-1.7,4-1.7h78.6C104.8,26.8,106.2,27.4,107.3,28.5z M45.7,118.5l-5.8-78c-0.1-1.5-1.4-2.6-2.9-2.5c-1.5,0.1-2.6,1.4-2.5,2.9l5.8,78c0.1,1.4,1.3,2.5,2.7,2.5c0.1,0,0.1,0,0.2,0C44.7,121.2,45.8,120,45.7,118.5z M66.8,40.7c0-1.5-1.2-2.7-2.7-2.7s-2.7,1.2-2.7,2.7v78c0,1.5,1.2,2.7,2.7,2.7s2.7-1.2,2.7-2.7V40.7z M93.6,40.9c0.1-1.5-1-2.8-2.5-2.9c-1.5-0.1-2.8,1-2.9,2.5l-5.8,78c-0.1,1.5,1,2.8,2.5,2.9c0.1,0,0.1,0,0.2,0c1.4,0,2.6-1.1,2.7-2.5L93.6,40.9z";


/**
 * Wrapping component for the activy center
 */
var ActivityWrapper = React.createClass({
    getInitialState() {
		return {
			activities: [],
            metadata: {}
		}
	},
    
    componentDidMount() {
        setInterval(() => {
            get(jQuery, 'http://activities.development.bibbox.org/activities/api/v1.0/activities', { limit: 15 }, function(result) {
                this.setState({
                    activities: result.content,
                    metadata: result.metadata
                });
            }.bind(this));
        }, 3000);
    },
    
    render: function() {
        return (
            <div id="activity-wrapper">
                <div>Activity Button</div>
                <div>
                    {
                        this.state.activities.map((activity) => {
                            let icon = '';
                            switch(activity.type) {
                                case 'INSTALLAPP': icon = installIcon; break;
                                case 'STARTAPP': icon = startStopIcon; break;
                                case 'STOPAPP': icon = startStopIcon; break;
                                case 'DELETEAPP': icon = deleteIcon; break;
                                defaut: icon = startStopIcon;
                            }
            
                            return (
                                <div key={activity.id} style={{display: 'block'}}>
                                    <span className="activity-state">{activity.state}</span>
                                    <span className="activity-icon">
                                        <svg style={{width: 20, height: 20}} viewBox="0 0 1000 1000">
                                            <path d={icon} />
                                        </svg>
                                    </span>
                                    <span className="activity-title">{activity.name}</span>
                                    <span className="activity-user">{activity.user_name}</span>
                                    <span className="activity-start-date">{activity.start_time}</span>
                                    <span className="activity-end-date">{activity.finished_time}</span>
                                </div>
                            );
                        })
                    }
                </div>
            </div>
        );
    }
});


/* Renders the application in the DOM */

ReactDOM.render(
  <ActivityWrapper />,
  document.getElementById('activity-wrapper')
);